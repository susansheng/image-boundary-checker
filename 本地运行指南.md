# 本地运行指南 - 图片边界验收工具

## 🔒 为什么选择本地运行？

**数据隐私保护**：
- ✅ 所有图片检测都在你的电脑上完成
- ✅ 表格文件不会上传到任何服务器
- ✅ 图片链接保持私密
- ✅ 完全离线处理（下载图片除外）

## 🚀 快速启动

### 方法一：使用启动脚本（推荐）

```bash
cd "/Users/sxsheng/Documents/代码/图片边界验收工具"
./start_local.sh
```

### 方法二：直接运行

```bash
cd "/Users/sxsheng/Documents/代码/图片边界验收工具"
python3 web_validator.py
```

## 🌐 访问地址

启动成功后，在浏览器中访问：
- **主地址**: http://127.0.0.1:5001
- **备用**: http://localhost:5001

## 📋 功能说明

### 1. 单张检测
- 点击或拖拽上传单张图片
- 立即查看检测结果
- 显示原始图和标注图对比

### 2. 批量检测
- 切换到"批量检测"选项卡
- 上传CSV或Excel表格文件
- 表格格式示例：

```csv
image_url
https://example.com/image1.png
https://example.com/image2.jpg
https://example.com/image3.png
```

**支持的列名**：
- url, image_url, img_url
- link, image, img
- 图片, 图片链接, 链接
- 或包含上述关键词的任意列名

## 🛠️ 技术要求

### 已安装的依赖
```bash
Flask==3.0.0
Pillow==10.2.0
Werkzeug==3.0.1
pandas==2.1.4
openpyxl==3.1.2
requests==2.31.0
```

### 如需重新安装依赖
```bash
cd "/Users/sxsheng/Documents/代码/图片边界验收工具"
pip3 install -r requirements.txt
```

## 📝 使用示例

### 测试单张图片

1. 启动本地服务器
2. 访问 http://127.0.0.1:5001
3. 上传任意图片进行测试

### 测试批量检测

1. 使用提供的测试文件：`test_batch.csv`
2. 切换到"批量检测"选项卡
3. 上传 `test_batch.csv`
4. 查看批量检测结果

## 🔧 常见问题

### Q1: 端口被占用怎么办？

如果5001端口也被占用，可以修改 `web_validator.py` 文件：

```python
# 找到最后一行
app.run(host='127.0.0.1', port=5001, debug=True)

# 修改为其他端口，例如：
app.run(host='127.0.0.1', port=5002, debug=True)
```

### Q2: 批量检测时图片下载失败？

可能原因：
- 图片链接无效或已过期
- 网络连接问题
- 图片URL需要认证

解决方法：
- 检查图片URL是否可以在浏览器中直接访问
- 确保网络连接正常
- 对于需要认证的URL，建议先下载图片后使用单张检测

### Q3: 如何停止服务器？

在终端窗口按 `Ctrl + C`

## 📊 数据处理说明

### 本地处理流程

1. **单张检测**：
   - 图片上传到本地Flask服务器（127.0.0.1）
   - 在你的电脑内存中处理
   - 不保存任何数据到磁盘
   - 关闭浏览器后数据消失

2. **批量检测**：
   - 表格文件上传到本地Flask服务器
   - 读取图片链接列表
   - 从URL下载图片到内存
   - 检测完成后立即释放内存
   - 不保存任何下载的图片

### 数据安全保证

✅ **不会上传到互联网**
- 所有处理都在 `127.0.0.1`（本地回环地址）
- 外部网络无法访问

✅ **不会保存到磁盘**
- 图片只在内存中处理
- 检测完成后自动释放

✅ **支持离线使用**
- 如果图片URL是内网地址，完全离线工作
- 如果图片URL是公网地址，需要联网下载

## 🆚 本地版 vs 在线版

| 特性 | 本地版 | 在线版 |
|------|--------|--------|
| **数据隐私** | ✅ 完全私密 | ⚠️ 上传到服务器 |
| **网络要求** | 仅下载图片时需要 | 始终需要 |
| **启动速度** | 需要手动启动 | 即开即用 |
| **性能** | 取决于本地电脑 | 取决于服务器 |
| **推荐场景** | 私密数据、大批量 | 临时使用、分享 |

## 💡 使用建议

**推荐使用本地版的场景**：
- ✅ 处理公司内部图片
- ✅ 批量检测大量图片
- ✅ 图片链接包含敏感信息
- ✅ 需要频繁使用

**可以使用在线版的场景**：
- ✅ 临时快速检测
- ✅ 分享给团队成员
- ✅ 演示和展示
- ✅ 公开图片链接

## 🔄 更新本地版本

如果在线版本有更新，同步到本地：

```bash
cd "/Users/sxsheng/Documents/代码/图片边界验收工具"
git pull origin main
pip3 install -r requirements.txt
```

## 📞 获取帮助

如有问题：
1. 检查终端输出的错误信息
2. 确认所有依赖已正确安装
3. 尝试重启服务器

---

**当前版本**: v2.0 (支持批量检测)
**更新日期**: 2026-02-04
**本地端口**: 5001
