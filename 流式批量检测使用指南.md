# 🎉 流式批量检测功能 - 使用指南

## ✨ 新功能亮点

### 🚀 实时流式处理
- ✅ **一边检测一边显示结果**：不用等全部完成
- ✅ **实时进度条**：清楚知道处理到哪里了
- ✅ **卡片式展示**：每张图片独立显示，一目了然
- ✅ **可随时停止**：不想等了可以中断
- ✅ **支持超大批量**：理论上可以处理几万张图片

### 📊 两种视图模式
1. **🎴 卡片视图**（默认）：美观直观，每张图片单独展示
2. **📊 表格视图**：数据紧凑，方便查看概览

## 🎯 使用步骤

### 1. 访问工具
打开浏览器访问：http://127.0.0.1:5001

### 2. 切换到批量检测
点击顶部的 **"📊 批量检测"** 选项卡

### 3. 准备Excel文件
你的Excel文件应该包含一列图片链接，例如：

| image_url |
|-----------|
| https://example.com/car1.jpg |
| https://example.com/car2.jpg |
| https://example.com/car3.jpg |
| ... |

**支持的列名**（会自动识别）：
- `url`, `image_url`, `img_url`, `link`
- `image`, `img`, `picture`
- `图片`, `图片链接`, `链接`

### 4. 上传文件
- 点击上传区域选择文件
- 或直接拖拽Excel/CSV文件到上传区域

### 5. 观看实时检测
上传后会自动开始检测，你可以看到：

#### 进度条区域
```
检测进度
进度: 50 / 3000    通过: 45    未通过: 3    失败: 2
[=========>              ] 50%
⏹ 停止检测
```

#### 结果卡片（实时显示）
每检测完一张，就会立即显示一个卡片：

**通过的卡片**（绿色边框）：
```
┌─────────────────────┐
│   [预览图]          │
│                     │
│  ✓ 通过             │
│  #123               │
│  图片符合规范要求    │
│  尺寸: 300×200      │
│  https://...        │
└─────────────────────┘
```

**未通过的卡片**（红色边框）：
```
┌─────────────────────┐
│   [预览图]          │
│                     │
│  ✗ 未通过           │
│  #456               │
│  发现50个像素超出...│
│  尺寸: 400×300      │
│  超出像素: 50       │
│  https://...        │
└─────────────────────┘
```

### 6. 查看结果
检测完成后：
- 自动显示汇总统计
- 可以切换 **卡片视图** 和 **表格视图**
- 点击图片链接可以在新标签页查看原图

## 🔧 高级功能

### 停止检测
如果批量太大不想等：
- 点击 **"⏹ 停止检测"** 按钮
- 已检测的结果会保留
- 可以查看已完成的部分

### 切换视图
完成后可以切换视图：
- **🎴 卡片视图**：适合快速浏览图片
- **📊 表格视图**：适合查看详细数据

### 导出结果（即将支持）
- 导出为Excel报告
- 包含所有检测详情
- 方便后续分析

## 📈 性能说明

### 检测速度
- **平均速度**：约 1 张/秒
- **100 张图片**：约 2-3 分钟
- **1000 张图片**：约 15-20 分钟
- **3000 张图片**：约 45-60 分钟

### 影响因素
1. **网络速度**：下载图片的速度
2. **图片大小**：大图片下载慢
3. **服务器响应**：图片服务器的速度

### 建议批量
- **日常使用**：100-500 张
- **大批量**：1000-3000 张
- **超大批量**：3000+ 张（可以分批处理）

## 🎨 界面说明

### 进度条
```
检测进度
进度: 150 / 3000 (5%)
通过: 120 | 未通过: 25 | 失败: 5
[=====>                  ] 5%
```

- **进度**：已检测/总数
- **通过**：符合规范的数量（绿色）
- **未通过**：不符合规范的数量（红色）
- **失败**：下载或检测失败的数量（灰色）

### 汇总统计
检测完成后显示：
```
┌────────────────────────────────────┐
│  3000        2850        100   50  │
│  总数         ✓通过      ✗未通过 失败│
└────────────────────────────────────┘
```

## 💡 使用技巧

### 1. 先小批量测试
第一次使用建议：
- 先测试 10-20 张
- 确认功能正常
- 再处理大批量

### 2. 保持浏览器打开
- 检测过程中保持页面打开
- 不要关闭浏览器标签
- 可以切换到其他标签页

### 3. 网络稳定很重要
- 确保网络连接稳定
- 失败的图片会显示失败原因
- 可以单独重新检测失败的

### 4. 大批量分时段处理
如果有 5000+ 张图片：
- 可以分成几个文件
- 分时段处理
- 避免长时间等待

## 🔍 常见问题

### Q1: 为什么有的图片显示"失败"？
**可能原因**：
- 图片链接无效或已过期
- 网络连接问题
- 图片URL需要认证
- 图片服务器响应慢

**解决方法**：
- 检查图片URL是否有效
- 重新尝试
- 单独处理失败的图片

### Q2: 可以中途暂停吗？
**当前版本**：只能停止，不能暂停
**计划**：未来版本会支持暂停/继续

### Q3: 结果会保存吗？
**当前版本**：只在浏览器中显示，关闭页面后消失
**计划**：未来版本会支持导出Excel报告

### Q4: 为什么检测这么慢？
**主要原因**：
- 需要逐个下载图片（网络速度影响）
- 每张图片要进行像素级检测
- 为了准确性，不能并行太多

**优化建议**：
- 确保网络连接良好
- 使用小一点的图片（如果可能）
- 分批处理大批量

### Q5: 支持多少张图片？
**理论上限**：取决于表格文件大小（16MB）
- CSV：约 16 万行
- Excel：约 33 万行

**实际建议**：
- 单次 100-500 张：最佳体验
- 单次 1000-3000 张：可接受
- 单次 3000+ 张：建议分批

## 🚀 即将推出的功能

### 1. 导出报告
- 导出Excel格式检测报告
- 包含所有图片的详细信息
- 可筛选通过/未通过

### 2. 暂停/继续
- 检测过程中可以暂停
- 暂停后可以继续
- 不会丢失进度

### 3. 失败重试
- 自动重试失败的图片
- 可配置重试次数
- 智能跳过永久失败的

### 4. 并行检测
- 同时检测多张图片
- 大幅提升速度
- 可配置并发数

### 5. 历史记录
- 保存检测历史
- 可查看之前的结果
- 支持对比分析

## 📞 需要帮助？

如果遇到问题或有建议，请告诉我：
- 具体的错误信息
- 检测的图片数量
- 浏览器类型和版本

---

**版本**: v2.1 (流式批量检测)
**更新日期**: 2026-02-04
**本地地址**: http://127.0.0.1:5001

**特别提醒**：
- 🔒 所有处理都在本地完成
- 🔒 图片在内存中检测，不保存到磁盘
- 🔒 保护你的数据隐私
