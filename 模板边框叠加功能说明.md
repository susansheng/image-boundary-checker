# 🎨 模板边框叠加功能说明

## ✨ 新功能

在 Web 界面的"检测预览"中，现在会自动叠加模板的红色边框，让你直观地看到图片内容是否超出了安全区域！

## 🎯 功能效果

### 预览图显示内容

**检测预览 (300 × 200) - 已叠加模板边框**

预览图现在包含：
1. **你上传的图片**（缩放到 300×200）
2. **红色半透明区域** - 标记禁区（不能放置内容的地方）
3. **绿色边界线** - 标记安全区域的边界

### 颜色说明

| 颜色 | 含义 | 说明 |
|------|------|------|
| 🔴 红色半透明区域 | 禁区 | 图片内容不能在这里 |
| 🟢 绿色边界线 | 安全区边界 | 内容必须在这条线内 |
| 白色/透明区域 | 安全区 | 图片内容可以在这里 |

## 📊 实际效果展示

### 情况 1：内容超出边界 ❌

```
┌────────────────────────────────────┐
│ 🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴│  红色区域
├────────────────────────────────────┤
│ 🟢━━━━━━━━━━━━━━━━━━━━━━━━━━━🟢 │  绿色边界
│ │  你的图片内容超出到这里了 🔵 │ │
│ │          ⬇️ 超出！          │ │
│ 🟢━━━━━━━━━━━━━━━━━━━━━━━━━━━🟢 │
├────────────────────────────────────┤
│ 🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴│  红色区域
└────────────────────────────────────┘

预览效果：你会看到图片内容被红色半透明区域覆盖
```

### 情况 2：内容在安全区域内 ✅

```
┌────────────────────────────────────┐
│ 🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴│  红色区域
├────────────────────────────────────┤
│ 🟢━━━━━━━━━━━━━━━━━━━━━━━━━━━🟢 │  绿色边界
│ │                              │ │
│ │    你的图片内容在这里 🔵     │ │
│ │                              │ │
│ 🟢━━━━━━━━━━━━━━━━━━━━━━━━━━━🟢 │
├────────────────────────────────────┤
│ 🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴🔴│  红色区域
└────────────────────────────────────┘

预览效果：图片内容在绿色边界线内，红色区域是空的
```

## 🎨 技术实现

### 叠加层构成

```python
1. 原始图片层（缩放到 300×200）
2. 红色边框叠加层（半透明）
   - 上边框：y = 0 到 23
   - 下边框：y = 176 到 199
   - 左边框：x = 0 到 13
   - 右边框：x = 286 到 299
3. 绿色边界线层
   - 边界线：x = 14, 285, y = 24, 175
```

### 透明度设置

- **红色禁区**：alpha = 120（约 47% 不透明）
  - 既能看到下面的图片内容
  - 又能清楚看到红色警告

- **绿色边界**：alpha = 180（约 71% 不透明）
  - 醒目但不过分遮挡

## 💡 使用场景

### 场景 1：调试图片内容位置

**问题**：不确定图片的某个元素是否超出边界

**解决**：
1. 上传图片到 Web 界面
2. 查看"检测预览"
3. 红色区域覆盖的部分 = 超出边界的内容
4. 调整图片后重新上传验证

### 场景 2：设计时参考

**问题**：设计图片时不确定安全区域的具体范围

**解决**：
1. 先上传一个测试版本
2. 看绿色边界线的位置
3. 根据边界线调整设计
4. 重新上传验证

### 场景 3：批量检测快速筛选

**问题**：需要从多张图片中快速找出不合规的

**解决**：
1. 逐个上传图片
2. 快速查看预览图
3. 有红色覆盖 = 不合规
4. 无红色覆盖 = 可能合规

## 🧪 测试建议

项目中包含了演示图片：

### demo_overflow.png
- **内容**：蓝色矩形明显超出边界
- **预期效果**：四周都会有红色半透明覆盖
- **用途**：演示超出边界的视觉效果

### demo_perfect_fit.png
- **内容**：紫色矩形刚好贴合边界
- **预期效果**：绿色边界线刚好在矩形边缘，无红色覆盖
- **用途**：演示刚好符合规范的情况

### 测试步骤

1. 访问 http://localhost:5000
2. 上传 demo_overflow.png
3. 观察预览图：
   - 蓝色矩形的边缘被红色半透明区域覆盖
   - 绿色边界线清晰可见
4. 上传 demo_perfect_fit.png
5. 观察预览图：
   - 紫色矩形完全在绿色边界线内
   - 没有被红色区域覆盖

## 📱 界面显示

### Web 界面布局

```
┌─────────────────────────────────────────────┐
│  原始图片 (600 × 400)                        │
│  ┌────────────────┐                          │
│  │                │                          │
│  │  你上传的图片   │                          │
│  │                │                          │
│  └────────────────┘                          │
└─────────────────────────────────────────────┘

┌─────────────────────────────────────────────┐
│  检测预览 (300 × 200) - 已叠加模板边框       │
│  🔴 红色区域 = 禁区 | 🟢 绿色边界 = 安全区边界│
│  ┌────────────────┐                          │
│  │ 🔴🔴🔴🔴🔴🔴 │                          │
│  │ 🟢━━━━━━━━🟢 │                          │
│  │ │  图片内容 │ │                          │
│  │ 🟢━━━━━━━━🟢 │                          │
│  │ 🔴🔴🔴🔴🔴🔴 │                          │
│  └────────────────┘                          │
└─────────────────────────────────────────────┘
```

## 🎯 优势总结

| 方面 | 之前 | 现在 |
|------|------|------|
| 可视化 | 仅数字提示 | 直观的颜色覆盖 |
| 理解难度 | 需要想象 | 一眼就能看出 |
| 调试效率 | 需要反复试错 | 立即看到问题 |
| 学习曲线 | 需要理解坐标 | 看颜色就懂 |

## ⚙️ 技术细节

### 边界坐标

```javascript
安全区域边界:
  左 (left):   14px
  右 (right):  285px
  上 (top):    24px
  下 (bottom): 175px

红色禁区范围:
  上边框: (0,0) 到 (299,23)
  下边框: (0,176) 到 (299,199)
  左边框: (0,24) 到 (13,175)
  右边框: (286,24) 到 (299,175)
```

### 颜色值

```python
红色半透明: rgba(232, 115, 107, 120)
绿色边界线: rgba(0, 255, 0, 180)
```

## 🚀 立即体验

1. 启动服务器（如果未启动）：
   ```bash
   ./start_server.sh
   ```

2. 访问 http://localhost:5000

3. 上传任意图片

4. 查看"检测预览"中的红色边框叠加效果

---

**更新日期**：2026-02-04
**版本**：3.0 with Template Overlay
